import{a as k}from"./vant.ec609186.js";import{bE as p,bU as b,bV as f,bF as t,bx as y,bt as w,bS as m,bM as I}from"./vendor.72e41cd8.js";import{I as v,h as c,F as l,B,a as x,v as D,b as S,M as _}from"./index.d030c2bc.js";import{s as d,o as V}from"./Tag.module.eeb5779d.js";const C=p({setup:(o,F)=>{const n=b(),e=f(),a=()=>{const{return_to:u}=n.query;u?e.push(u.toString()):e.back()};return()=>t(v,{name:"left",onClick:a},null)}}),N=p({props:{id:Number},setup:(o,F)=>{const n=b(),e=y({id:void 0,name:"",sign:"",kind:n.query.kind.toString()}),a=y({}),u=f(),g=async s=>{s.preventDefault();const r=[{key:"name",type:"required",message:"\u5FC5\u586B"},{key:"name",type:"pattern",regex:/^.{1,4}$/,message:"\u53EA\u80FD\u586B 1 \u5230 4 \u4E2A\u5B57\u7B26"},{key:"sign",type:"required",message:"\u5FC5\u586B"}];Object.assign(a,{name:[],sign:[]}),Object.assign(a,D(e,r)),S(a)||(await(await e.id?c.patch(`/tags/${e.id}`,e,{_mock:"tagEdit",_autoLoading:!0}):c.post("/tags",e,{_mock:"tagCreate",_autoLoading:!0})).catch(E=>V(E,h=>Object.assign(a,h.errors))),u.back())};return w(async()=>{if(!o.id)return;const s=await c.get(`/tags/${o.id}`,{},{_mock:"tagShow"});Object.assign(e,s.data.resource)}),()=>t(x,{onSubmit:g},{default:()=>{var s,r;return[t(l,{label:"\u6807\u7B7E\u540D\uFF08\u6700\u591A 4 \u4E2A\u5B57\u7B26\uFF09",type:"text",modelValue:e.name,"onUpdate:modelValue":i=>e.name=i,error:(s=a.name)==null?void 0:s[0]},null),t(l,{label:"\u7B26\u53F7 "+e.sign,type:"emojiSelect",modelValue:e.sign,"onUpdate:modelValue":i=>e.sign=i,error:(r=a.sign)==null?void 0:r[0]},null),t(l,null,{default:()=>[t("p",{class:d.tips},[m("\u8BB0\u8D26\u65F6\u957F\u6309\u6807\u7B7E\u5373\u53EF\u8FDB\u884C\u7F16\u8F91")])]}),t(l,null,{default:()=>[t(B,{type:"submit",class:[d.button]},{default:()=>[m("\u786E\u5B9A")]})]})]}})}}),M=p({setup:(o,F)=>{const n=b(),e=parseInt(n.params.id.toString());if(Number.isNaN(e))return()=>t("div",null,[m("id \u4E0D\u5B58\u5728")]);const a=f(),u=()=>{k.alert({title:"\u63D0\u793A",message:"\u5220\u9664\u5931\u8D25"})},g=async s=>{await k.confirm({title:"\u786E\u8BA4",message:"\u4F60\u771F\u7684\u8981\u5220\u9664\u5417\uFF1F"}),await c.delete(`/tags/${e}`,{with_items:s!=null&&s.withItems?"true":"false"},{_autoLoading:!0}).catch(u),a.back()};return()=>t(_,null,{title:()=>"\u7F16\u8F91\u6807\u7B7E",icon:()=>t(C,null,null),default:()=>t(I,null,[t(N,{id:e},null),t("div",{class:d.actions},[t(B,{level:"danger",class:d.removeTagsAndItems,onClick:()=>g({withItems:!0})},{default:()=>[m("\u5220\u9664\u6807\u7B7E\uFF08\u5BF9\u5E94\u8BB0\u8D26\u4E5F\u4F1A\u88AB\u5220\u9664\uFF09")]})])])})}});export{M as TagEdit,M as default};
